<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run TransPhylo on a Set of Trees — run_TransPhylo • beast2tpPipeline</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run TransPhylo on a Set of Trees — run_TransPhylo"><meta name="description" content="This is a wrapper for TransPhylo::infer_multittree_share_param.
Can use it to run TransPhylo on a set of trees, either all MCC trees
with parameter sharing, or a sample of posterior BEAST2 trees without
parameter sharing (i.e., a sample of BEAST2 posterior trees for a single
cluster, to incorporate some phylogenetic uncertainty)."><meta property="og:description" content="This is a wrapper for TransPhylo::infer_multittree_share_param.
Can use it to run TransPhylo on a set of trees, either all MCC trees
with parameter sharing, or a sample of posterior BEAST2 trees without
parameter sharing (i.e., a sample of BEAST2 posterior trees for a single
cluster, to incorporate some phylogenetic uncertainty)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">beast2tpPipeline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mcc_tree_pipeline.html">Using the BEAST2 - TransPhylo Pipeline with Maximum Clade Credibility Trees</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run TransPhylo on a Set of Trees</h1>

      <div class="d-none name"><code>run_TransPhylo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a wrapper for TransPhylo::infer_multittree_share_param.
Can use it to run TransPhylo on a set of trees, either all MCC trees
with parameter sharing, or a sample of posterior BEAST2 trees without
parameter sharing (i.e., a sample of BEAST2 posterior trees for a single
cluster, to incorporate some phylogenetic uncertainty).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_TransPhylo</span><span class="op">(</span></span>
<span>  <span class="va">trees</span>,</span>
<span>  cluster_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcctrees"</span>, <span class="st">"trees_sample"</span><span class="op">)</span>,</span>
<span>  <span class="va">cluster_dict</span>,</span>
<span>  out_dir <span class="op">=</span> <span class="st">"TransPhylo"</span>,</span>
<span>  output_name <span class="op">=</span> <span class="st">"tp_res"</span>,</span>
<span>  gentime_shape <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  gentime_scale <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">10</span>,</span>
<span>  sampling_shape <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  sampling_scale <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">10</span>,</span>
<span>  prior_sampfrac_a <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prior_sampfrac_b <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  start_off_p <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  start_neg <span class="op">=</span> <span class="fl">1.48</span>,</span>
<span>  start_pi <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  start_off_r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  share <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"neg"</span>, <span class="st">"off.r"</span><span class="op">)</span>,</span>
<span>  update_neg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  update_off_r <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  update_off_p <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  update_pi <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  optiStart <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  mcmc_iterations <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  thinning <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-trees">trees<a class="anchor" aria-label="anchor" href="#arg-trees"></a></dt>
<dd><p>An <code>ape</code> multiPhylo object containing the trees to be
analyzed. If <code>type</code> is "mcctrees", this should be all MCC trees for
all clusters, and the names of the trees need to match the names
of the trees in the cluster dictionary. If <code>type</code> is "trees_sample",
this should be a sample of posterior BEAST2 trees for a single cluster,
and the cluster name should be provided as an argument.</p></dd>


<dt id="arg-cluster-name">cluster_name<a class="anchor" aria-label="anchor" href="#arg-cluster-name"></a></dt>
<dd><p>If type is "trees_sample", this should be the name
of the cluster for which the trees are being analyzed. This should match
the cluster name in the cluster dictionary. If type is "mcctrees", this
argument is ignored.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A character string specifying the type of trees to be
analyzed. Can be "mcctrees" or "trees_sample". If "mcctrees", this
function will run TransPhylo on all MCC trees for all clusters. If
"trees_sample", this function will run TransPhylo on a sample of
posterior BEAST2 trees for a single cluster.</p></dd>


<dt id="arg-cluster-dict">cluster_dict<a class="anchor" aria-label="anchor" href="#arg-cluster-dict"></a></dt>
<dd><p>A data frame containing <code>sample_id</code>, <code>cluster_name</code>,
and <code>collectdt</code> for each sequence, as output by <code>assign_snp_clusters</code>.</p></dd>


<dt id="arg-out-dir">out_dir<a class="anchor" aria-label="anchor" href="#arg-out-dir"></a></dt>
<dd><p>A character string specifying the directory where
the TransPhylo results will be saved.</p></dd>


<dt id="arg-output-name">output_name<a class="anchor" aria-label="anchor" href="#arg-output-name"></a></dt>
<dd><p>A character string specifying the name of the output
file.</p></dd>


<dt id="arg-gentime-shape">gentime_shape<a class="anchor" aria-label="anchor" href="#arg-gentime-shape"></a></dt>
<dd><p>A numeric specifying the shape parameter of the gamma
distribution for the generation time.</p></dd>


<dt id="arg-gentime-scale">gentime_scale<a class="anchor" aria-label="anchor" href="#arg-gentime-scale"></a></dt>
<dd><p>A numeric specifying the scale parameter of the gamma
distribution for the generation time.</p></dd>


<dt id="arg-sampling-shape">sampling_shape<a class="anchor" aria-label="anchor" href="#arg-sampling-shape"></a></dt>
<dd><p>A numeric specifying the shape parameter of the gamma
distribution for the sampling time. Default is the same as <code>gentime_shape</code>.</p></dd>


<dt id="arg-sampling-scale">sampling_scale<a class="anchor" aria-label="anchor" href="#arg-sampling-scale"></a></dt>
<dd><p>A numeric specifying the scale parameter of the gamma
distribution for the sampling time. Default is the same as <code>gentime_scale</code>.</p></dd>


<dt id="arg-prior-sampfrac-a">prior_sampfrac_a<a class="anchor" aria-label="anchor" href="#arg-prior-sampfrac-a"></a></dt>
<dd><p>A numeric specifying the first shape parameter of the beta
distribution for the sampling fraction.</p></dd>


<dt id="arg-prior-sampfrac-b">prior_sampfrac_b<a class="anchor" aria-label="anchor" href="#arg-prior-sampfrac-b"></a></dt>
<dd><p>A numeric specifying the second shape parameter of the beta
distribution for the sampling fraction.</p></dd>


<dt id="arg-start-off-p">start_off_p<a class="anchor" aria-label="anchor" href="#arg-start-off-p"></a></dt>
<dd><p>A numeric specifying the starting value for the off.p parameter.</p></dd>


<dt id="arg-start-neg">start_neg<a class="anchor" aria-label="anchor" href="#arg-start-neg"></a></dt>
<dd><p>A numeric specifying the starting value for the neg parameter.</p></dd>


<dt id="arg-start-pi">start_pi<a class="anchor" aria-label="anchor" href="#arg-start-pi"></a></dt>
<dd><p>A numeric specifying the starting value for the pi parameter.</p></dd>


<dt id="arg-start-off-r">start_off_r<a class="anchor" aria-label="anchor" href="#arg-start-off-r"></a></dt>
<dd><p>A numeric specifying the starting value for the off.r parameter.</p></dd>


<dt id="arg-share">share<a class="anchor" aria-label="anchor" href="#arg-share"></a></dt>
<dd><p>A character vector specifying which parameters to share across
clusters. Defaults to "neg" and "off.r". If <code>type</code> is "trees_sample", this
parameter is ignored.</p></dd>


<dt id="arg-update-neg">update_neg<a class="anchor" aria-label="anchor" href="#arg-update-neg"></a></dt>
<dd><p>A logical specifying whether to update the neg parameter.</p></dd>


<dt id="arg-update-off-r">update_off_r<a class="anchor" aria-label="anchor" href="#arg-update-off-r"></a></dt>
<dd><p>A logical specifying whether to update the off.r parameter.</p></dd>


<dt id="arg-update-off-p">update_off_p<a class="anchor" aria-label="anchor" href="#arg-update-off-p"></a></dt>
<dd><p>A logical specifying whether to update the off.p parameter.</p></dd>


<dt id="arg-update-pi">update_pi<a class="anchor" aria-label="anchor" href="#arg-update-pi"></a></dt>
<dd><p>A logical specifying whether to update the pi parameter.</p></dd>


<dt id="arg-optistart">optiStart<a class="anchor" aria-label="anchor" href="#arg-optistart"></a></dt>
<dd><p>A numeric specifying type of optimization to apply to
MCMC start point.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical specifying whether to print verbose output.</p></dd>


<dt id="arg-delta-t">delta_t<a class="anchor" aria-label="anchor" href="#arg-delta-t"></a></dt>
<dd><p>The grid size for the MCMC. Smaller is better but slower.</p></dd>


<dt id="arg-mcmc-iterations">mcmc_iterations<a class="anchor" aria-label="anchor" href="#arg-mcmc-iterations"></a></dt>
<dd><p>A numeric specifying the number of MCMC iterations.</p></dd>


<dt id="arg-thinning">thinning<a class="anchor" aria-label="anchor" href="#arg-thinning"></a></dt>
<dd><p>A numeric specifying the thinning parameter for the MCMC.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing the probability of each sample being an
infection source.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jessalyn Sebastian.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

